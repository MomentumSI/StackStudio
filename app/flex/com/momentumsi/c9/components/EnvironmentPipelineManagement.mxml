<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx" 
		 width="100%" height="100%"
		 creationComplete="creationCompleteHandler(event)" 
		 xmlns:models="com.momentumsi.c9.models.*" 
		 xmlns:components="com.momentumsi.c9.components.*">
	<fx:Script>
		<![CDATA[
			import flexunit.utils.ArrayList;
			
			import mx.events.CloseEvent;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			
			protected function creationCompleteHandler(event:FlexEvent):void
			{

			}
			
			protected function addStage_clickHandler(event:MouseEvent):void
			{
				var newEnv:Environment = new Environment();
				newEnv.name = environmentName.text;
				environments.addItem(newEnv);
				environmentsList.selectedIndex = environments.length - 1;
				if(project.project_id != null)
				{
					project.createEnvironment(newEnv);
				}
			}
			
			
			protected function removeStage_clickHandler(event:MouseEvent):void
			{
				var removedEnv:Environment = environments.removeItemAt(environmentsList.selectedIndex) as Environment;
				if(project.project_id != null)
				{
					project.removeEnvironment(removedEnv.name);
				}
			}
			
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<models:Project id="project"/>
		<s:ArrayCollection id="environments">
			<models:Environment name="{Environment.DEVELOPMENT}"/>
			<models:Environment name="{Environment.TEST}"/>
			<models:Environment name="{Environment.STAGING}"/>
			<models:Environment name="{Environment.PRODUCTION}"/>
		</s:ArrayCollection>
	</fx:Declarations>
	<s:VGroup width="100%" height="100%" id="environmentManagerBody">
		<s:Form height="100%" width="100%">
			<s:FormItem label="Name:">
				<s:TextInput id="environmentName" width="158"/>
			</s:FormItem>
			<s:FormItem label="Current Environments:">
				<s:List id="environmentsList" width="158" dataProvider="{environments}"/>
			</s:FormItem>
		</s:Form>
		<s:HGroup paddingLeft="20" paddingTop="10" paddingBottom="10" paddingRight="20" width="100%">
			<s:HGroup horizontalAlign="left" width="100%">
				<s:Button id="addStage" label="Add Stage" click="addStage_clickHandler(event)" enabled="{environmentName.text.replace(/\s/g) != ''}"/>
				<s:Button id="removeStage" label="Remove Stage" click="removeStage_clickHandler(event)"/>
			</s:HGroup>
			<s:HGroup width="100%" horizontalAlign="right" includeInLayout="false" visible="false" id="closeButtonGroup">
				<s:Button label="Close" id="closeButton" click="owner.dispatchEvent(new CloseEvent(CloseEvent.CLOSE))"/>
			</s:HGroup>
		</s:HGroup>
	</s:VGroup>
</s:Group>
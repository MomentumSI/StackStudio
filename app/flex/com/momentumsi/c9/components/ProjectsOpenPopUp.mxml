<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   title="Projects"
			   close="PopUpManager.removePopUp(this)"
			   initialize="init(event)"
			   creationComplete="openProjectsWindow_creationCompleteHandler(event)"
			   width="482" height="350"
			   fontSize="13">

	<fx:Script>
		<![CDATA[
			import com.momentumsi.c9.events.ProjectEvent;
			import com.momentumsi.c9.models.*;
			import com.momentumsi.c9.utils.Helpers;
			
			import mx.events.FlexEvent;
			import mx.managers.CursorManager;
			import mx.managers.PopUpManager;
			import mx.rpc.events.ResultEvent;
			import mx.rpc.http.mxml.HTTPService;
			
			[Bindable]
			private var environmentIds:Array = new Array();
			
			[Bindable]
			private var user:User; 
			private var selectedProject:Project;
			
			protected function init(event:FlexEvent):void
			{
				user = parentApplication.user;
			}
			
			protected function openProjectsWindow_creationCompleteHandler(event:FlexEvent):void
			{
				PopUpManager.centerPopUp(this);
			}
			
			private function openProjectChangeEvt(event:MouseEvent):void
			{
				loadButton.enabled = false;
				selectedProject = projectsList.selectedItem as Project;
				
				var openProject:Project = new Project();
				openProject.project_name = selectedProject.project_name;
				openProject.project_id = selectedProject.project_id;
				var bodyStack:BodyStack = parentApplication.bodyStack;
				bodyStack.addProjectToGlobalTabs(openProject);
				PopUpManager.removePopUp(this);
			}
			
			protected function cancel_clickHandler(event:MouseEvent):void
			{
				PopUpManager.removePopUp(this);
			}

			
			private function disableWindowInteraction(disable:Boolean):void
			{
				if(disable){		
					cancelButton.enabled = false;
					loadButton.label = "Loading";
					this.closeButton.enabled = false;
					loadButton.enabled = false;
				}else{		
					cancelButton.enabled = true;
					loadButton.label = "Load";
					this.closeButton.enabled = true;
					loadButton.enabled = true;
				}
			}
			
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->		
		<mx:DateFormatter id="dateFormatter" formatString="MM/DD/YYYY"/>
	</fx:Declarations>
	<s:VGroup height="100%" width="100%" paddingTop="20" paddingLeft="15" paddingRight="15">
		<mx:Text text="What project would you like to load?" paddingBottom="25"/>
		<s:HGroup width="100%" height="188" gap="5">
			<s:VGroup width="100%" height="100%">
				<mx:Text text="Projects" fontWeight="bold" color="black"/>
				<s:BorderContainer cornerRadius="4" height="100%" width="100%">
					<s:Rect width="100%" height="100%">
						<s:fill>
							<s:SolidColor>
								<s:color>0x330066</s:color>
							</s:SolidColor>
						</s:fill>
					</s:Rect>
					<s:List id="projectsList"
							styleName="transparentList"
							dataProvider="{user.project_memberships}"
							height="100%" width="100%" color="white"
						 	allowMultipleSelection="false"/>
				</s:BorderContainer>
			</s:VGroup>
		</s:HGroup>
		<s:HGroup width="100%" horizontalAlign="center" paddingTop="20">
			<s:Button label="Load" id="loadButton" click="openProjectChangeEvt(event)" enabled="{projectsList.selectedItem != null}"/>
			<s:Button label="Cancel" id="cancelButton" click="cancel_clickHandler(event)"/>
		</s:HGroup>
	</s:VGroup>
</s:TitleWindow>

<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx" 
			   title="Reset Password"
			   initialize="init(event)"
			   creationComplete="popUpHandler(event)"
			   width="400" height="300">
	
	<fx:Script>
		<![CDATA[
			import mx.controls.Alert;
			import mx.core.FlexGlobals;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			import mx.rpc.events.ResultEvent;
			
			[Bindable]
			private var host:String;
			private var app:Object = FlexGlobals.topLevelApplication;
			
			protected function init(event:FlexEvent):void
			{
				// TODO Auto-generated method stub
				host = app.GetConfiguration("serviceUrl");
			}
			
			protected function passwordResetHandler(event:MouseEvent):void
			{
				if(newPassword.text == confirmPassword.text)
				{
					passwordResetSvc.send({login: login.text});
					PopUpManager.removePopUp(this);
				}else{
					Alert.show("Passwords do not match, please re-enter and try again.");
				}
				
			}
			
			protected function passwordResetSvc_resultHandler(event:ResultEvent):void
			{
				var result:XML = XML(event.result);
			}
			
			
			
			protected function popUpHandler(event:FlexEvent):void
			{
				// TODO Auto-generated method stub
				PopUpManager.centerPopUp(this);
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<s:HTTPService id="passwordResetSvc"
					   url="{host}/user/reset_password"
					   resultFormat="e4x"
					   method="POST"
					   showBusyCursor="true"
					   result="passwordResetSvc_resultHandler(event)"/>
		
	</fx:Declarations>
	<s:VGroup x="57" y="33" horizontalAlign="center" verticalAlign="middle">
		<s:Form fontWeight="normal" textAlign="right">
			<s:FormItem label="Login ID:" fontWeight="bold">
				<s:TextInput id="login" fontWeight="normal" textAlign="center"/>
			</s:FormItem>
			<s:FormItem label="New Password:" fontWeight="bold">
				<s:TextInput id="newPassword" fontWeight="normal" textAlign="center"/>
			</s:FormItem>
			<s:FormItem label="Confirm Password:" fontWeight="bold">
				<s:TextInput id="confirmPassword" fontWeight="normal" textAlign="center"/>
			</s:FormItem>
		</s:Form>
		<s:HGroup>
			<s:Button label="Cancel" click="PopUpManager.removePopUp(this)"/>
			<s:Button label="Reset Password" click="passwordResetHandler(event)"/>
		</s:HGroup>
	</s:VGroup>
	
</s:TitleWindow>

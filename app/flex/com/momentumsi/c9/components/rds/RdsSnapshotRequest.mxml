<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009" 
			   xmlns:s="library://ns.adobe.com/flex/spark" 
			   xmlns:mx="library://ns.adobe.com/flex/mx" 
			   title="Take DB Snapshot"
			   close="PopUpManager.removePopUp(this)"
			   initialize="init(event)"
			   move="Helpers.doMove(this)"
			   creationComplete="PopUpManager.centerPopUp(this)"
			   width="400" height="225">
	<fx:Script>
		<![CDATA[
			import mx.core.FlexGlobals;
			import mx.events.CloseEvent;
			import mx.events.FlexEvent;
			import mx.managers.PopUpManager;
			import mx.rpc.events.ResultEvent;
			import com.momentumsi.c9.utils.Helpers;
			
			[Bindable]
			private var host:String;
			private var app:Object = FlexGlobals.topLevelApplication;
			
			protected function init(event:FlexEvent):void
			{
				// TODO Auto-generated method stub
				host = app.GetConfiguration( "serviceUrl" ) ;
			}
			
			protected function snapshotButton_clickHandler(event:MouseEvent):void
			{
				// TODO Auto-generated method stub
				createDbSnapshotSvc.send({snapshot_name: snapshotName.text});
				PopUpManager.removePopUp(this);
				
			}

			protected function createDbSnapshotSvc_resultHandler(event:ResultEvent):void
			{

			}
			
		]]>
	</fx:Script>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		<fx:XML id="rdsInstance"/>
		
		<s:HTTPService id="createDbSnapshotSvc"
					   url="{host}/rds_db_instances/create_db_snapshot/{rdsInstance.child('id')}.xml"
					   resultFormat="e4x"
					   method="GET"
					   showBusyCursor="true"
					   result="createDbSnapshotSvc_resultHandler(event)"/>
		
	</fx:Declarations>
	<s:VGroup width="100%" height="122">
		<mx:Text paddingLeft="15" text="To take a snapshot of this DB you must provide a name for&#13;the snapshot."/>
		<s:Form>
			<s:layout>
				<s:FormLayout gap="-5"/>
			</s:layout>
			<s:FormItem label="DB Instance:">
				<mx:Text text="{rdsInstance.child('rds-db-instance-identifier')}"/>
			</s:FormItem>
			<s:FormItem label="Snapshot Name:">
				<s:TextInput id="snapshotName" color="black"/>
			</s:FormItem>
		</s:Form>
	</s:VGroup>
	<s:Button id="snapshotButton" x="104" y="161" label="Take Snapshot"
			  click="snapshotButton_clickHandler(event)"/>
	<s:Button x="226" y="161" label="Cancel" click="PopUpManager.removePopUp(this)"/>
</s:TitleWindow>
